<!doctype html>
<html
  xmlns:th="https://www.thymeleaf.org"
  th:replace="~{modules/layout :: layout(title = ${site.title}, content = ~{::content}, head = ~{::head}, bodyClass = 'page-home page-single')}"
>
  <th:block th:fragment="head">
    <link rel="stylesheet" th:href="${#theme.assets('/build/page-home.css')}" />
    <link rel="stylesheet" th:href="${#theme.assets('/build/page-single.css')}" />
  </th:block>
  <th:block th:fragment="content">
    <th:block
      th:with="homePageNameRaw=${theme.config.global != null
                 ? new com.fasterxml.jackson.databind.ObjectMapper().readTree(theme.config.global.toString()).path('home_page').asText('__EMPTY__')
                 : '__EMPTY__'},
               homePageName=${#strings.equals(homePageNameRaw, '__EMPTY__') ? '' : homePageNameRaw},
               homePage=${!#strings.isEmpty(homePageName) ? singlePageFinder.getByName(homePageName) : null}"
    >
      <article class="content-block" th:if="${homePage != null}">
        <header class="content-header">
          <h1 class="content-title" th:text="${homePage.spec.title}"></h1>
        </header>
        <div
          class="content-body"
          th:utext="${homePage.content != null && homePage.content.content != null ? homePage.content.content : ''}"
        ></div>
      </article>
      <section class="content-block home-intro" th:if="${homePage == null}">
        <header class="content-header">
          <h1 class="content-title">首页未配置</h1>
          <p class="content-desc">请在主题设置-全局中选择“默认首页关联页面”。</p>
        </header>
      </section>
    </th:block>
  </th:block>
</html>
