<!doctype html>
<html
  xmlns:th="https://www.thymeleaf.org"
  th:replace="~{modules/layout :: layout(title = ${docTree.spec.title} + ' - ' + ${site.title}, content = ~{::content}, head = ~{::head}, bodyClass = 'page-doc page-docsme')}"
>
  <th:block th:fragment="head">
    <link rel="stylesheet" th:href="${#theme.assets('/build/page-docsme.css')}" />
    <script type="module" th:src="${#theme.assets('/build/page-docsme.js')}"></script>
    <th:block th:if="${pluginFinder.available('PluginDocsme') or pluginFinder.available('plugin-docsme')}">
      <th:block th:replace="~{plugin:plugin-docsme:modules/style}" />
      <th:block th:replace="~{plugin:plugin-docsme:modules/script}" />
      <th:block th:replace="~{plugin:plugin-docsme:modules/plugin-scripts}" />
    </th:block>
  </th:block>
  <th:block th:fragment="content">
    <th:block th:if="${pluginFinder.available('PluginDocsme') or pluginFinder.available('plugin-docsme')}">
      <div
        class="dm-container dm-container--embedded"
        th:with="annotations=${docTree != null and docTree.metadata != null ? docTree.metadata.annotations : null},
                 articleIdPluginAvailable=${pluginFinder.available('article-id-management') or pluginFinder.available('plugin-article-id-management')},
                 articleIdStatusRaw=${annotations != null ? annotations['article-id-management/status'] : null},
                 articleIdStatus=${#strings.equals(articleIdStatusRaw, 'REGISTERED') ? '已注册'
                    : (#strings.equals(articleIdStatusRaw, 'BOUND') ? '已绑定'
                    : (#strings.equals(articleIdStatusRaw, 'SUPERSEDED') ? '已替代'
                    : (#strings.equals(articleIdStatusRaw, 'VOID') ? '已作废'
                    : (#strings.equals(articleIdStatusRaw, 'DELETED') ? '已删除' : articleIdStatusRaw))))},
                 articleIdFullCode=${annotations != null ? annotations['article-id-management/fullCode'] : null},
                 articleIdDisplay=${articleIdPluginAvailable and !#strings.isEmpty(articleIdStatus) and !#strings.isEmpty(articleIdFullCode) ? '[' + articleIdStatus + ']' + articleIdFullCode : ''}"
      >
        <th:block
          th:replace="~{plugin:plugin-docsme:modules/header :: header(showThemeSwitcher = false)}"
        />
        <th:block th:replace="~{modules/docsme-local/doc :: doc(footer = null)}" />
      </div>
    </th:block>
    <section
      class="content-block"
      th:if="${not (pluginFinder.available('PluginDocsme') or pluginFinder.available('plugin-docsme'))}"
    >
      <header class="content-header">
        <h1 class="content-title">Docsme 插件未启用</h1>
        <p class="content-desc">请安装并启用 Docsme 插件后再访问该页面。</p>
      </header>
    </section>
  </th:block>
</html>
